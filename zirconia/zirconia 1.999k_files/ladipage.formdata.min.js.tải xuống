LadiPageScriptV2.prototype.runOptionForm=function(t,e,i){var a,n=this,o=window.ladi("LADI_FUNNEL_NEXT_URL").get_cookie(),r=window.ladi("LADI_CAMP_TARGET_URL").get_cookie(),d=window.ladi("LADI_CAMP_CONFIG").get_cookie(),c=document.getElementsByClassName("ladi-form"),s=0,u=null,p=null,l=null,m=null,_=null,g=null,f=null,y=null,h=null,E=null,v=null,L=null,P=null,A=null,w=null,O=null,T=null,b=null,k=n.runtime.shopping,N=null,S=["utm_source","utm_medium","utm_campaign","utm_term","utm_content"],R=["name","email","phone","address","ward","district","state","country"],C=["email","phone"],D=n.copy(n.runtime.list_set_value_name_country).reverse(),F=function(t,e){var i="_capture_"+t,a=window.ladi(i).get_cookie(),o=!1,r=n.runtime.tmp["cookie_cache_otp_"+t];if(isEmptyLadiPage(a)&&isObjectLadiPage(r)&&!isEmptyLadiPage(r[i])&&(a=r[i],o=!0),isEmptyLadiPage(a)){a=e+"|"+n.runtime.ladipage_id+"|"+Date.now()+"|"+n.randomId();var d=new Date;d.setTime(d.getTime()+9e5),o?(r[i]=a,n.runtime.tmp["cookie_cache_otp_"+t]=r):window.ladi(i).set_cookie(a,d)}return a},I=function(t,e,i){var a=n.runtime.tmp["form_data_ladi_"+E];if(isObjectLadiPage(a))return!0;if(e&&isEmptyLadiPage(p[i]))return!1;var o=[];if(T.forEach(function(t){isEmptyLadiPage(p[t])&&o.push(t)}),e&&(o=o.only([i])),o.length>0)return e||n.showMessage(n.const.LANG.FORM_INPUT_REQUIRED_ERROR,null,function(){var e=t.querySelector('[name="'+o[0]+'"]');isEmptyLadiPage(e)||e.focus()}),!1;var r=!0,d=t.getElementsByClassName("ladi-survey");for(g=0;g<d.length;g++){var c=n.findAncestor(d[g],"ladi-element");if(!isEmptyLadiPage(c)){var s=n.runtime.eventData[c.id];if(!isEmptyLadiPage(s)&&s["option.survey_setting.input_required"]&&!isEmptyLadiPage(s["option.survey_setting.input_name"])){var u=c.id,l=t.querySelector('.ladi-element.ladi-form-item-survey[data-name="'+s["option.survey_setting.input_name"]+'"]');isEmptyLadiPage(l)||(u=l.id);var m=window.ladi(u).value();if(isEmptyLadiPage(m)){r=!1;break}}}}if(!r)return e||n.showMessage(n.const.LANG.FORM_INPUT_REQUIRED_ERROR),!1;var _=!0,g=0,f=function(){var e=t.querySelector('[name="'+b[g].name+'"]');isEmptyLadiPage(e)||e.focus()};for(g=0;g<b.length;g++)if(!e||b[g].name==i){var y=p[b[g].name];if(!isEmptyLadiPage(y))try{if(!new RegExp("^"+b[g].pattern+"$",b[g].pattern_flag).test(y)){e||n.showMessage(b[g].title,null,f),_=!1;break}}catch(t){}}return _},x=function(t,e){p={},l={},m={};for(var i=t.querySelectorAll(".ladi-element .ladi-form-item-container [name]"),a={},o=null,r=0;r<i.length;r++)o=i[r].getAttribute("name"),a[o]=parseInt(i[r].getAttribute("tabindex"))||0;var d=Object.keys(a).sort(function(t,e){return a[t]-a[e]});if(d.only(n.runtime.list_set_value_name_country).length==n.runtime.list_set_value_name_country.length)for(var c=0;c<d.length;c++){var s=n.runtime.list_set_value_name_country.indexOf(d[c]);-1!=s&&(d[c]=D[s])}for(var u=0;u<d.length;u++)p[d[u]]="";f=d;for(var g=0;g<i.length;g++){o=i[g].getAttribute("name"),i[g].required&&-1==T.indexOf(o)&&T.push(o);var y=null;if("INPUT"==i[g].tagName){y=i[g].getAttribute("type").trim().toLowerCase();var h=i[g].getAttribute("pattern"),E=i[g].getAttribute("title");if("email"==y?b.push({name:o,pattern:'(([^<>()\\[\\]\\\\.,;:\\s@"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@"]+)*)|(".+"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))',pattern_flag:"gi",title:n.const.LANG.FORM_INPUT_EMAIL_REGEX}):isEmptyLadiPage(h)||b.push({name:o,pattern:h,title:isEmptyLadiPage(E)?n.const.LANG.FORM_INPUT_TEXT_REGEX:E}),"checkbox"==y){isArrayLadiPage(p[o])||(p[o]=[]),i[g].checked&&p[o].push(i[g].value);continue}if("radio"==y){i[g].checked&&(p[o]=i[g].value);continue}}if(p[o]=i[g].value,i[g].classList.contains("ladi-form-control-file")&&(p[o]=JSON.parse(i[g].getAttribute("data-path-file")||"[]"),m[o]=!0),"coupon"==o&&"INPUT"==i[g].tagName&&"text"==y&&"true"==i[g].getAttribute("data-replace-coupon")&&(p[o]=n.runtime.tmp.current_use_coupon||""),"INPUT"==i[g].tagName&&"date"==y&&!isEmptyLadiPage(p[o])){var v=i[g].getAttribute("date-format")||"dd-mm-yyyy",L=new Date(p[o]);v=(v=(v=(v=v.replaceAll("dd",(L.getDate()<10?"0":"")+L.getDate())).replaceAll("mm",(L.getMonth()+1<10?"0":"")+(L.getMonth()+1))).replaceAll("yyyy",L.getFullYear())).replaceAll("yy",L.getFullYear()-2e3),p[o]=v}}e||R.forEach(function(t){isNullLadiPage(p[t])||(window.ladi("_ladipage_"+t).set_cookie(p[t],365,"/",window.location.host),isArrayLadiPage(n.runtime.DOMAIN_SET_COOKIE)&&n.runtime.DOMAIN_SET_COOKIE.forEach(function(e){e!=window.location.host&&window.ladi("_ladipage_"+t).set_cookie(p[t],365,"/",e)}))}),_=n.runtime.tmp.convertFormDataObjectCountry(p)},M=function(t,e,a,o,c){var l={form_config_id:y,ladi_form_id:E,ladipage_id:n.runtime.ladipage_id,tracking_form:[],form_data:[],data_key:o};if(a)l.status_send=n.const.STATUS_SEND.capture;else if(l.status_send=n.const.STATUS_SEND.sendform,k){var _=window.ladi("_checkout_token").get_cookie();isEmptyLadiPage(_)||(l.checkout_token=_)}if(!isEmptyLadiPage(v)){var g=v.getElementsByClassName("ladiflow-widget")[0];isEmptyLadiPage(g)||(isObjectLadiPage(l.options)||(l.options={}),l.options.ladiflow_trigger_id=g.getAttribute("ladiflow-trigger-id"),l.options.ladiflow_ref=g.getAttribute("ladiflow-ref"),l.options.ladiflow_page_id=g.getAttribute("page_id"),l.options.ladiflow_checkbox_user_ref=g.getAttribute("user_ref"),l.options.ladiflow_store_id=g.getAttribute("ladiflow-store-id"),s=1e3,u=function(){isObjectLadiPage(window.LadiFlow)&&isFunctionLadiPage(window.LadiFlow.resetWidgetCheckbox)&&window.LadiFlow.resetWidgetCheckbox(g.id)})}isEmptyLadiPage(L)||["option.sync_ladisales_form_account_id","option.sync_ladiflow_form_account_id","option.sync_ladishare_form_account_id","option.sync_ladichat_form_account_id"].forEach(function(t){isEmptyLadiPage(L[t])||(isObjectLadiPage(l.options)||(l.options={}),isArrayLadiPage(l.options.external_form_config_ids)||(l.options.external_form_config_ids=[]),l.options.external_form_config_ids.push(L[t]))}),e.isFormOtp&&!isEmptyLadiPage(h)&&(isObjectLadiPage(l.options)||(l.options={}),isObjectLadiPage(l.options.external_otp_config)||(l.options.external_otp_config={}),l.options.external_otp_config.otp_config_id=h),isObjectLadiPage(l.options)&&(l.options=JSON.stringify(l.options)),isEmptyLadiPage(P)||(l.total_revenue=P),isEmptyLadiPage(n.runtime.time_zone)||(l.time_zone=n.runtime.time_zone);var T=Object.keys(LadiFormApi);if(f.forEach(function(t){var e=p[t];isArrayLadiPage(e)&&0==e.length&&(e="");var i={name:t,value:e=-1!=T.indexOf(t)?LadiFormApi[t]:e};m[t]&&(i.is_file=!0),l.form_data.push(i)}),(T=T.except(f)).forEach(function(t){l.form_data.push({name:t,value:LadiFormApi[t]})}),k){if(!isNullLadiPage(A)){l.form_data.push({name:"cart_products",value:A,is_ladipage:!0}),isEmptyLadiPage(n.runtime.tmp.add_to_cart_shipping_method_id)||l.form_data.push({name:"cart_shipping",value:n.runtime.tmp.add_to_cart_shipping_method_id+"|"+(n.runtime.tmp.add_to_cart_fee_shipping||0),is_ladipage:!0});var b=l.form_data.findIndex(function(t){return"coupon"==t.name});-1!=b&&(l.form_data[b].is_ladipage=!0)}isEmptyLadiPage(P)||l.form_data.push({name:"cart_revenue",value:P,is_ladipage:!0}),isEmptyLadiPage(n.runtime.tmp.current_use_coupon)||l.form_data.push({name:"cart_coupon_amount",value:n.runtime.tmp.add_to_cart_discount||0,is_ladipage:!0})}l.tracking_form.push({name:"url_page",value:window.location.href}),n.runtime.has_popupx&&l.tracking_form.push({name:"origin_url_page",value:n.runtime.tmp.popupx_origin_url}),S.forEach(function(t){var e=N[t];e=isNullLadiPage(e)?"":e,l.tracking_form.push({name:t,value:e})}),l.tracking_form.push({name:"variant_url",value:r}),l.tracking_form.push({name:"variant_content",value:n.generateVariantContentString(d,!0)}),isEmptyLadiPage(i)||l.tracking_form.push({name:n.const.REF_NAME,value:i}),n.runtime.tmp["form_data_ladi_tmp_"+E]=n.copy(l);var R=n.runtime.tmp["form_data_ladi_"+E];isObjectLadiPage(R)&&(l=n.copy(R)),isEmptyLadiPage(w)||(l.captcha_token=w,l.captcha_type=O);e.isFormOtp&&(e.isSetOtpId&&function(){var t="_otp_id_"+E,i=window.ladi(t).get_cookie(),a=!1,o=n.runtime.tmp["cookie_cache_otp_"+E];isEmptyLadiPage(i)&&isObjectLadiPage(o)&&!isEmptyLadiPage(o[t])&&(i=o[t],a=!0);var r=new Date,d=[];isEmptyLadiPage(i)?d=[n.randomId(),r.getTime(),1]:((d=i.split("|"))[1]=parseInt(d[1])||Date.now(),d[2]=parseInt(d[2])||1,e.isSendOtp||(d[2]+=1),d.splice(3)),d[2]<=1?l.otp_send=n.const.OTP_TYPE.send:l.otp_send=n.const.OTP_TYPE.resend,r.setTime(d[1]+9e5),i=d.join("|"),a?(o[t]=i,n.runtime.tmp["cookie_cache_otp_"+E]=o):window.ladi(t).set_cookie(i,r),d.splice(1),i=d.join("|"),l.otp_id=i}(),l.is_capture=e.isCapture,l.otp_type=n.const.OTP_TYPE.sms,l.status_send=n.const.STATUS_SEND.otp),e.isSendOtp&&(l.otp_code=e.otp_code,l.status_send=n.const.STATUS_SEND.sendform),isFunctionLadiPage(c)&&c(l)},q=function(t){t.reset();var e=t.getElementsByClassName("ladi-survey-option");for(W=0;W<e.length;W++)e[W].classList.remove("selected");var i=t.querySelectorAll(".ladi-element .ladi-form-item-container .ladi-form-checkbox-item input");for(W=0;W<i.length;W++){var a=n.findAncestor(i[W],"ladi-form-checkbox-item").querySelector("span");isEmptyLadiPage(a)||a.setAttribute("data-checked",i[W].checked)}var o=n.findAncestor(t,"ladi-element");if(!isEmptyLadiPage(o)){for(var r=document.querySelectorAll('.ladi-form [data-submit-form-id="'+o.id+'"]'),d=0;d<r.length;d++){var c=n.findAncestor(r[d],"ladi-form");if(!isEmptyLadiPage(c)&&(c=n.findAncestor(c,"ladi-element"),!isEmptyLadiPage(c))){var s=c.querySelector(".ladi-form-remove-coupon");if(isEmptyLadiPage(s)){var u=c.querySelector('input[name="coupon"]');isEmptyLadiPage(u)||(u.value="",n.fireEvent(u,"change"))}else s.click()}}var p=document.getElementById(o.getAttribute("data-form-id-before"));isEmptyLadiPage(p)||(p=p.getElementsByClassName("ladi-form")[0],q(p))}for(var l=document.querySelectorAll('[data-combobox-type="delivery_method"]'),m=0;m<l.length;m++)l[m].hasAttribute("data-placeholder")&&(l[m].innerHTML='<option value="">'+l[m].getAttribute("data-placeholder")+"</option>"),l[m].setAttribute("data-selected","");for(var _=document.querySelectorAll(".ladi-google-recaptcha-checkbox[data-widget-id]"),g=0;g<_.length;g++){var f=_[g].getAttribute("data-widget-id");isEmptyLadiPage(f)||window.grecaptcha&&isObjectLadiPage(n.runtime.tmp.google_captcha)&&n.runtime.tmp.google_captcha.checkbox&&isFunctionLadiPage(window.grecaptcha.reset)&&window.grecaptcha.reset(f)}n.runtime.tmp.add_to_cart_shipping_method_id=null},U=function(t,e,i,a){x(i,!1),I(i,!1,null)&&(M(0,e,!1,a,function(t){n.sendRequest("POST",n.const.API_FORM_DATA,JSON.stringify(t),!0,{"Content-Type":"application/json"})}),n.showMessage(n.const.LANG.FORM_SEND_DATA_NO_CONFIG),q(i))},j=function(){n.showMessage(n.const.LANG.FORM_CAPTCHA_ERROR)},Y=function(t,e,i,a,o){if(_={},g={},f=[],T=[],b=[],x(t,i),I(t,i,a)){for(var r=t.querySelectorAll(".ladi-element .ladi-form-item-container [name]"),d={},c=null,s=0;s<r.length;s++)c=n.findAncestor(r[s],"ladi-element"),d[r[s].getAttribute("name")]=c.id;var u=e["option.form_setting"],l=Object.keys(d);if((u.mapping_form_id||[]).forEach(function(e){var u=document.getElementById(e);if(!isEmptyLadiPage(u)){u.setAttribute("data-form-id-before",t.id);var p=n.runtime.eventData[u.id];if(!i||!isEmptyLadiPage(p)&&p["option.form_auto_capture"]){isFunctionLadiPage(o.getOtp)&&!isEmptyLadiPage(p)&&p["option.is_form_otp"]&&(isFunctionLadiPage(o.beforeRunOtp)&&o.beforeRunOtp(u),n.runtime.func_get_code_otp[u.id]=o.getOtp);var m=[];if(l.forEach(function(t){var e=window.ladi(d[t]).value();r=u.querySelectorAll('.ladi-element .ladi-form-item-container [name="'+t+'"]');var i=[];for(s=0;s<r.length;s++)c=n.findAncestor(r[s],"ladi-element"),i.push(c.id),t==a&&m.push(r[s]);for(i=i.unique(),s=0;s<i.length;s++)window.ladi(i[s]).value(e)}),i)for(s=0;s<m.length;s++)n.fireEvent(m[s],"focusout")}}}),!i){var m=e["option.data_event"];if(!isArrayLadiPage(m)){var y=n.copy(u);if(m=[],isObjectLadiPage(y)&&(y.type=y.event_type,y.value=y.event_value,y.is_hide_parent=y.event_is_hide_parent,y.change_index_type=y.event_change_index_type,y.change_index_number=y.event_change_index_number,!isEmptyLadiPage(y.value))){if(y.type!=n.const.DATA_ACTION_TYPE.section&&y.type!=n.const.DATA_ACTION_TYPE.popup||m.push({action_type:n.const.ACTION_TYPE.complete,type:y.type,action:y.value}),y.type==n.const.DATA_ACTION_TYPE.section&&y.is_hide_parent||y.type==n.const.DATA_ACTION_TYPE.popup){var h=n.findAncestor(t,"ladi-popup"),E=n.findAncestor(t,"ladi-section"),v=null;isEmptyLadiPage(h)?isEmptyLadiPage(E)||(v=E.id):v=(h=n.findAncestor(h,"ladi-element")).id,isEmptyLadiPage(v)||m.push({action_type:n.const.ACTION_TYPE.complete,type:n.const.DATA_ACTION_TYPE.hidden_show,hidden_ids:[v],show_ids:[]})}y.type==n.const.DATA_ACTION_TYPE.change_index&&m.push({action_type:n.const.ACTION_TYPE.complete,type:y.type,action:y.value,change_index_type:y.change_index_type,change_index_number:y.change_index_number})}}n.runtime.tmp.runDataEventComplete(t,m)}o.isRunTracking&&n.runEventTracking(t.id,{is_form:!0},p)}},G=function(e,i,a,r,d,c){if(N=n.getURLSearchParams(null,null,!1),s=0,u=null,p={},l={},m={},_={},g={},f=[],y=null,h=null,E=null,v=null,L=null,P=null,A=null,w=i.captcha_token,isObjectLadiPage(n.runtime.tmp.google_captcha)&&(O=n.runtime.tmp.google_captcha.type,!a&&isEmptyLadiPage(w)&&i.hasOwnProperty("captcha_token")))j();else{T=[],b=[],k=n.findAncestor(e,"ladi-popup"),isEmptyLadiPage(k)?k=!1:(k=n.findAncestor(k,"ladi-element"),k=!isEmptyLadiPage(k)&&"POPUP_CHECKOUT"==k.id);var R=e.getElementsByClassName("ladi-form")[0];if(!isEmptyLadiPage(R)){var C=n.runtime.eventData[e.id];if(!isEmptyLadiPage(C)){if(C["option.is_add_to_cart"])return;y=C["option.form_config_id"],h=isObjectLadiPage(C["option.form_setting"])?C["option.form_setting"].otp_config_id:null,E=e.id,v=e,L=C,P=parseFloatLadiPage(C["option.form_purchase_value"])||0,k&&(P=n.getCartCheckoutPrice(P),A=n.getCartProducts())}var D=null,F=null,Y=null,B=null;if(a){if(isEmptyLadiPage(r))return;if(x(R,a),!I(R,a,d))return;if(i.captcha&&!isEmptyLadiPage(C)&&C["option.form_captcha"]&&isObjectLadiPage(n.runtime.tmp.google_captcha)){if(window.grecaptcha)if(n.runtime.tmp.google_captcha.enterprise&&window.grecaptcha.enterprise)window.grecaptcha.enterprise.ready(function(){try{window.grecaptcha.enterprise.execute(n.runtime.tmp.google_captcha.api_key,{action:"submit"}).then(function(t){G(e,{captcha_token:t},a,r,d,c)})}catch(t){}});else if(n.runtime.tmp.google_captcha.checkbox)try{D=e.getElementsByClassName("ladi-google-recaptcha-checkbox")[0],F=e.getAttribute("data-button-submit-other"),isEmptyLadiPage(F)||(D=document.querySelector("#"+F+" .ladi-google-recaptcha-checkbox")),Y=D.getAttribute("data-widget-id"),B=window.grecaptcha.getResponse(Y),G(e,{captcha_token:B},a,r,d,c)}catch(t){}else window.grecaptcha.ready(function(){try{window.grecaptcha.execute(n.runtime.tmp.google_captcha.api_key,{action:"submit"}).then(function(t){G(e,{captcha_token:t},a,r,d,c)})}catch(t){}});return}M(0,c,a,r,function(t){var e=t.form_data.findIndex(function(t){return t.name==d}),i=-1!=e?t.form_data[e].value:null;!isEmptyLadiPage(n.runtime.tmp.capture_form_data_last[r+"_"+d])&&equalsLadiPage(n.runtime.tmp.capture_form_data_last[r+"_"+d],i)||(n.runtime.tmp.capture_form_data_last[r+"_"+d]=i,n.sendRequest("POST",n.const.API_FORM_DATA,JSON.stringify(t),!0,{"Content-Type":"application/json"}))})}else if(isEmptyLadiPage(C))U(0,c,R,r);else if(isNullLadiPage(n.runtime.tmp.form_sending)&&(n.runtime.tmp.form_sending={}),isNullLadiPage(n.runtime.tmp.form_button_headline)&&(n.runtime.tmp.form_button_headline={}),!n.runtime.tmp.form_sending[e.id]){var H=function(){n.runtime.tmp.form_sending[e.id]=!0;var t=R.querySelector(".ladi-button .ladi-headline");isNullLadiPage(n.runtime.tmp.form_button_headline[e.id])&&(n.runtime.tmp.form_button_headline[e.id]=t.innerHTML),c.isFormOtp||(t.innerHTML="● ● ●")},J=function(){delete n.runtime.tmp.form_sending[e.id],R.querySelector(".ladi-button .ladi-headline").innerHTML=n.runtime.tmp.form_button_headline[e.id]};if(i.captcha&&!isEmptyLadiPage(C)&&C["option.form_captcha"]&&isObjectLadiPage(n.runtime.tmp.google_captcha))if(window.grecaptcha)if(H(),n.runtime.tmp.google_captcha.enterprise&&window.grecaptcha.enterprise)window.grecaptcha.enterprise.ready(function(){try{window.grecaptcha.enterprise.execute(n.runtime.tmp.google_captcha.api_key,{action:"submit"}).then(function(t){J(),G(e,{captcha_token:t},a,r,d,c)}).catch(function(){j(),J()})}catch(t){j(),J()}});else if(n.runtime.tmp.google_captcha.checkbox)try{D=e.getElementsByClassName("ladi-google-recaptcha-checkbox")[0],F=e.getAttribute("data-button-submit-other"),isEmptyLadiPage(F)||(D=document.querySelector("#"+F+" .ladi-google-recaptcha-checkbox")),Y=D.getAttribute("data-widget-id"),B=window.grecaptcha.getResponse(Y),J(),G(e,{captcha_token:B},a,r,d,c)}catch(t){j(),J()}else window.grecaptcha.ready(function(){try{window.grecaptcha.execute(n.runtime.tmp.google_captcha.api_key,{action:"submit"}).then(function(t){J(),G(e,{captcha_token:t},a,r,d,c)}).catch(function(){j(),J()})}catch(t){j(),J()}});else n.showMessage(n.const.LANG.FORM_CAPTCHA_LOADING);else{var Q=C["option.form_send_ladipage"],X=C["option.form_api_data"],K=C["option.thankyou_type"],V=C["option.thankyou_value"],W=C["option.deeplink_value"],z=C["option.form_auto_funnel"],Z=C["option.form_thankyou_funnel"],$=function(){isObjectLadiPage(c)&&isFunctionLadiPage(c.callbackOtpShowThankYouDone)&&c.callbackOtpShowThankYouDone(),isFunctionLadiPage(u)&&u();var i=!1;if(n.runtime.has_popupx&&n.runtime.tmp.popupx_is_inline)i=!0;else if(K!=n.const.FORM_THANKYOU_TYPE.url){var a=n.findAncestor(e,"ladi-popup");isEmptyLadiPage(a)||(a=n.findAncestor(a,"ladi-element"),n.runRemovePopup(a.id,t))}var r=0;if(!n.runtime.isDesktop&&!isEmptyLadiPage(W)){r=1e3;var d=n.convertDataReplaceStr(W,!0,null,!1,g);window.ladi(d).open_url()}if(!Z||isEmptyLadiPage(o)){if(K==n.const.FORM_THANKYOU_TYPE.default&&(isEmptyLadiPage(V)||n.showMessage(V,g)),K==n.const.FORM_THANKYOU_TYPE.popup&&(z&&n.setDataReplaceElement(!1,!1,g,V),window.ladi(V).show(!1,{formThankyouPopupXInline:i})),K==n.const.FORM_THANKYOU_TYPE.url&&!isEmptyLadiPage(V)){var s=window.ladi(V).get_url(l,z,!1);n.runTimeout(function(){window.ladi(s).open_url()},r)}}else{var p=window.ladi(o).get_url(l,z,!1);n.runTimeout(function(){window.ladi(p).open_url()},r)}};if(C["option.only_facebook_widget"]){if(isObjectLadiPage(window.LadiFlow)&&isFunctionLadiPage(window.LadiFlow.confirmCheckbox))for(var tt=e.getElementsByClassName("ladiflow-widget"),et=0;et<tt.length;et++)window.LadiFlow.confirmCheckbox(tt[et].id);return n.runEventTracking(e.id,{is_form:!0},p),void $()}if(isEmptyLadiPage(y)&&isEmptyLadiPage(C["option.sync_ladisales_form_account_id"])&&isEmptyLadiPage(C["option.sync_ladiflow_form_account_id"])&&isEmptyLadiPage(C["option.sync_ladishare_form_account_id"])&&isEmptyLadiPage(C["option.sync_ladichat_form_account_id"]))U(0,c,R,r);else if(x(R,a),I(R,a,d)){var it=0,at=0,nt=null,ot=[],rt=!1,dt=!1,ct=!0,st=function(t){t&&q(R),J()},ut=function(t){if(-1!=[n.const.FORM_CONFIG_TYPE.sapo,n.const.FORM_CONFIG_TYPE.shopify,n.const.FORM_CONFIG_TYPE.haravan,n.const.FORM_CONFIG_TYPE.wordpress].indexOf(n.runtime.shopping_product_type)&&n.runtime.tmp.cart.length>0){var e=!1;-1!=[n.const.FORM_CONFIG_TYPE.haravan,n.const.FORM_CONFIG_TYPE.wordpress].indexOf(n.runtime.shopping_product_type)&&(e=!0);var i=n.runtime.tmp.cart[0];return i=JSON.stringify(i),i=encodeURIComponent(i),void n.removeAddToCartProduct(i,!1,e,function(e){e?ut(t):isFunctionLadiPage(t)&&t()})}-1!=[n.const.FORM_CONFIG_TYPE.ladisales].indexOf(n.runtime.shopping_product_type)&&(window.ladi("_cart_token").delete_cookie(),window.ladi("_checkout_token").delete_cookie(),n.createCartData()),isFunctionLadiPage(t)&&t()},pt=function(t,i,a,o){if(a.readyState==XMLHttpRequest.DONE){var r={};try{r=JSON.parse(t)}catch(t){}r=isObjectLadiPage(r)?r:{},o==n.const.API_FORM_DATA?200==r.code?it++:(1!=r.code||isEmptyLadiPage(r.message)||(nt=r.message),at++,ct=!1):200==i||201==i?it++:n.getElementAHref(o).host==n.const.DOMAIN_GOOGLE_DOCS?it++:at++,it+at==ot.length&&(ct&&!rt&&it>=1?(rt=!0,isFunctionLadiPage(c.callbackOtp)&&c.callbackOtp(!0),isObjectLadiPage(c)&&isFunctionLadiPage(c.callbackThankyou)?(J(),c.callbackThankyou(c,function(){ut(function(){st(!0),n.runtime.tmp.current_use_coupon=null})})):(l=n.copy(p),g=n.copy(_),Object.keys(n.runtime.replaceStr).forEach(function(t){l.hasOwnProperty(t)||(l[t]=n.runtime.replaceStr[t]),g.hasOwnProperty(t)||(g[t]=n.runtime.replaceStr[t])}),function(t,e,i){var a=null,o=!1,r=function(t,e){o||(isFunctionLadiPage(i)&&i(t,e),n.removeTimeout(a),o=!0)};a=n.runTimeout(r,3e3),n.runtime.tmp.runTrackingAnalytics("FormSubmit",{ladi_form_id:t,total_revenue:e},r)}(e.id,P,function(t,i){n.runEventTracking(e.id,{is_form:!0},p),window.ladi("_capture_"+e.id).delete_cookie(),isObjectLadiPage(c)&&isFunctionLadiPage(c.callbackOtpDone)&&c.callbackOtpDone(),ut(function(){n.runTimeout(function(){st(!0),n.runtime.tmp.current_use_coupon=null,$()},500)})}))):!dt&&at>=1&&(isFunctionLadiPage(c.callbackOtp)&&c.callbackOtp(!1),dt=!0,n.showMessage(nt||n.const.LANG.REQUEST_SEND_ERROR),st(!1)))}},lt=function(t){ot.push({url:n.const.API_FORM_DATA,data:JSON.stringify(t),async:!0,headers:{"Content-Type":"application/json"},callback:pt})};Q&&M(0,c,a,r,lt),isArrayLadiPage(X)&&X.forEach(function(t){if(!isEmptyLadiPage(t.api_url)&&isArrayLadiPage(t.custom_fields)){var e=n.getElementAHref(t.api_url).host==n.const.DOMAIN_GOOGLE_DOCS,i={},a=null,o=null,r=null,d=null;t.custom_fields.forEach(function(t){if(k&&("cart_products"==t.ladi_name&&(a=t.name),"cart_revenue"==t.ladi_name&&(o=t.name),"cart_shipping"==t.ladi_name&&(r=t.name),"cart_coupon_amount"==t.ladi_name&&(d=t.name)),!m[t.ladi_name]){var e=_[t.ladi_name];isNullLadiPage(e)||(isArrayLadiPage(e)?0==e.length?i[t.name]="":i[t.name]=JSON.stringify(e):i[t.name]=e)}}),isEmptyLadiPage(a)||isNullLadiPage(A)||(i[a]=JSON.stringify(A)),isEmptyLadiPage(o)||isNullLadiPage(P)||(i[o]=P),isEmptyLadiPage(r)||isNullLadiPage(n.runtime.tmp.add_to_cart_shipping_method_id)||(i[r]=n.runtime.tmp.add_to_cart_shipping_method_id+"|"+(n.runtime.tmp.add_to_cart_fee_shipping||0)),isEmptyLadiPage(d)||isEmptyLadiPage(n.runtime.tmp.current_use_coupon)||(i[d]=n.runtime.tmp.add_to_cart_discount||0);var c={};if(!isEmptyLadiPage(t.api_request_header))try{var s=JSON.parse(t.api_request_header);Object.keys(s).forEach(function(t){c[t]=s[t]})}catch(t){}if(!e)i.link=window.location.href,n.runtime.has_popupx&&(i.origin_link=n.runtime.tmp.popupx_origin_url),Object.keys(LadiFormApi).forEach(function(t){i[t]=LadiFormApi[t]}),S.forEach(function(t){var e=N[t];isNullLadiPage(e)||(i[t]=e)});var u=null,p=t.content_type||n.const.CONTENT_TYPE.form_urlencoded;if(p==n.const.CONTENT_TYPE.form_urlencoded&&(c["Content-Type"]="application/x-www-form-urlencoded",u=Object.keys(i).reduce(function(t,e){return t.push(e+"="+encodeURIComponent(i[e])),t},[]).join("&")),p==n.const.CONTENT_TYPE.json&&(c["Content-Type"]="application/json",u=JSON.stringify(i)),p==n.const.CONTENT_TYPE.form_data)u=new FormData,Object.keys(i).forEach(function(t){u.append(t,i[t])});ot.push({url:t.api_url,data:u,async:!0,headers:c,callback:pt})}});(ot.length>0||!Q)&&H(),n.runTimeout(function(){0==ot.length&&(Q?U(0,c,R,r):M(0,c,a,r,lt)),ot.forEach(function(t){n.sendRequest("POST",t.url,t.data,t.async,t.headers,t.callback)})},s)}}}}}},B=function(t){var e=n.findAncestor(t.target,"ladi-element");if(!isEmptyLadiPage(e))for(var i=e.querySelectorAll('[type="checkbox"]'),a=0;a<i.length;a++)i[a].removeAttribute("required")},H=function(t){var e=n.findAncestor(t.target,"ladi-element");if(!isEmptyLadiPage(e)){var a=n.runtime.eventData[e.id];if(!isEmptyLadiPage(a)&&a["option.is_form_otp"])return!1;for(var o=e.querySelectorAll('[ladi-checkbox-required="true"]'),r=-1,d=0;d<o.length;d++)if(0==o[d].querySelectorAll('[type="checkbox"]:checked').length){r=d;break}if(-1==r){var c=function(t){var i=!1,n=null;isEmptyLadiPage(a["option.form_config_id"])||((a["option.form_auto_capture"]||t.isFormOtp)&&(n=F(e.id,a["option.form_config_id"])),a["option.form_auto_capture"]&&(i=!0));var o={captcha:!0};(t.isResendOtp||t.isSendOtp)&&(o.captcha=!1),t.isFormOtp&&(t.isCapture=i),G(e,o,!1,n,null,t)},s=function(t){window.ladi("_capture_"+e.id).delete_cookie(),window.ladi("_otp_id_"+e.id).delete_cookie();var i=[];isObjectLadiPage(a["option.form_setting"])&&(i=a["option.form_setting"].mapping_form_id||[]),i.forEach(function(e){window.ladi("_otp_time_"+e).delete_cookie(),t&&delete n.runtime.tmp["cookie_cache_otp_"+e]}),t&&(delete n.runtime.tmp["cookie_cache_otp_"+e.id],delete n.runtime.tmp["form_data_ladi_"+e.id],delete n.runtime.tmp["form_data_ladi_tmp_"+e.id])},u=function(t){var e=t.getElementsByClassName("ladi-form")[0],i=n.findAncestor(t,["ladi-popup","ladi-element"]),a=function(){var i=t.getAttribute("data-form-id-before");delete n.runtime.func_get_code_otp[t.id],delete n.runtime.tmp["cookie_cache_otp_"+t.id],delete n.runtime.tmp["cookie_cache_otp_"+i],delete n.runtime.tmp["form_data_ladi_"+i],delete n.runtime.tmp["form_data_ladi_tmp_"+i],window.ladi("_otp_time_"+t.id).delete_cookie(),window.ladi("_otp_id_"+i).delete_cookie(),t.removeAttribute("data-form-id-before"),e.onsubmit=function(){return!1}},o=function(){isEmptyLadiPage(i)||window.ladi(i.id).hide(),e.reset()};e.onsubmit=function(){var e=t.querySelector('input[name="otp"]');return isEmptyLadiPage(e)||(e=e.value.trim(),c({isFormOtp:!0,isSetOtpId:!0,isSendOtp:!0,otp_code:e,callbackOtpDone:a,callbackOtpShowThankYouDone:o})),!1}},l=function(t,e){c({isFormOtp:!0,isSetOtpId:!0,isResendOtp:t,callbackOtp:e,callbackThankyou:m})},m=function(t,i){t.isFormOtp&&!t.isResendOtp&&function(){var t={};t["_capture_"+e.id]=null,t["_otp_id_"+e.id]=null;var i=Object.keys(t);i.forEach(function(e){t[e]=window.ladi(e).get_cookie()}),n.runtime.tmp["cookie_cache_otp_"+e.id]=t;var o=[];isObjectLadiPage(a["option.form_setting"])&&(o=a["option.form_setting"].mapping_form_id||[]),o.forEach(function(e){(t={})["_otp_time_"+e]=null,(i=Object.keys(t)).forEach(function(e){t[e]=window.ladi(e).get_cookie()}),n.runtime.tmp["cookie_cache_otp_"+e]=t}),n.runtime.tmp["form_data_ladi_"+e.id]=n.runtime.tmp["form_data_ladi_tmp_"+e.id]}(),s(!1),Y(e,a,!1,null,{isRunTracking:!1,getOtp:l,beforeRunOtp:u}),isFunctionLadiPage(i)&&i()};if(!isEmptyLadiPage(a)&&a["option.is_form_login"])!function(t,e){var i=t.querySelector('input[name="access_key"]');if(!isEmptyLadiPage(i)&&!isEmptyLadiPage(i.value)){for(var a=[],o=0,r=1;r<=50;r++){var d=window.ladi("_login_token_"+r).get_cookie();0==o&&isEmptyLadiPage(d)&&(o=r),a.push(d)}if(0==o){for(r=1;r<=50;r++)window.ladi("_login_token_"+r).delete_cookie();a=[],o=1}n.sendRequest("POST",n.const.API_ACCESS_KEY_LOGIN,JSON.stringify({tokens:a.removeSpace(),url:window.location.href,code:i.value.toUpperCase()}),!0,{"Content-Type":"application/json"},function(t,e,i,r){if(i.readyState==XMLHttpRequest.DONE){var d={},c=n.const.LANG.FORM_LOGIN_SEND_ERROR;try{if(200==(d=JSON.parse(t)).code){var s=a.findIndex(function(t){return t==d.data.token});-1!=s&&(o=s+1),window.ladi("_login_token_"+o).set_cookie(d.data.token,7);var u=n.getElementAHref(d.data.url,!0),p=window.location.search;return(p.startsWith("?")||p.startsWith("&"))&&(p=p.substring(1)),isEmptyLadiPage(p)||(u.search=u.search+(isEmptyLadiPage(u.search)?"?":"&")+p),void window.ladi(u.href).open_url()}c=d.message||c}catch(t){}n.showMessage(c)}})}}(e);else if(!isEmptyLadiPage(a)&&isObjectLadiPage(a["option.form_setting"])&&a["option.form_setting"].is_multiple)a["option.form_setting"].is_multiple_otp?(s(!0),l(!1,function(t){if(t){var e=[];isObjectLadiPage(a["option.form_setting"])&&(e=a["option.form_setting"].mapping_form_id||[]),e.forEach(function(t){var e=document.getElementById(t);if(!isEmptyLadiPage(e)){var i=e.querySelector(".ladi-form-item .button-get-code");isEmptyLadiPage(i)||(e.setAttribute("data-start-countdown-otp",!0),i.click())}})}})):Y(e,a,!1,null,{isRunTracking:!0});else{if(n.runtime.shopping_product_type==n.const.FORM_CONFIG_TYPE.ladisales&&!isNullLadiPage(n.runtime.shopping_config_checkout_id)){var y=n.findAncestor(e,"ladi-popup");if(!isEmptyLadiPage(y)&&(y=n.findAncestor(y,"ladi-element"),!isEmptyLadiPage(y)&&"POPUP_CHECKOUT"==y.id))return function(t){var e=window.ladi("_cart_token").get_cookie(),a=window.ladi("_checkout_token").get_cookie();_={},g={},f=[],T=[],b=[],x(t,!1);var o=p.email,r=p.phone;if(isEmptyLadiPage(e)||isEmptyLadiPage(a))n.showMessage(n.const.LANG.FORM_INPUT_REQUIRED_ERROR);else if(isEmptyLadiPage(o)&&isEmptyLadiPage(r))n.showMessage(n.const.LANG.FORM_INPUT_REQUIRED_ERROR);else{var d=p.name,c=p.address,s=p.message,u=p.country||"";u=u.split(":")[0];var l=p.state||"";l=l.split(":")[0];var m=p.district||"";m=m.split(":")[0];var y=p.ward||"";y=y.split(":")[0];var h=p.coupon,E=n.runtime.tmp.add_to_cart_shipping_method_id,v=n.getLadiSaleCheckoutCartProducts(),L={cart_token:e,checkout_token:a,discount_code:h,customer_first_name:d,customer_email:o,customer_phone:r,customer_address:c,customer_note:s,customer_country_code:u,customer_state_id:l,customer_district_id:m,customer_ward_id:y,shipping_method_id:E,shipping_first_name:d,shipping_address:c,shipping_phone:r,shipping_email:o,shipping_country_code:u,shipping_state_id:l,shipping_district_id:m,shipping_ward_id:y,shipping_note:s,checkout_config_id:n.runtime.shopping_config_checkout_id,is_export_invoice:0,is_generate_url:!0,variants:v,utm:{url_page:window.location.href}};N=n.getURLSearchParams(null,null,!1),S.forEach(function(t){L.utm[t]=isNullLadiPage(N[t])?"":N[t]}),n.runtime.has_popupx&&(L.utm.origin_url_page=n.runtime.tmp.popupx_origin_url),isEmptyLadiPage(i)||(L.utm[n.const.REF_NAME]=i),L.custom_fields={};var P=Object.keys(p);(P=P.except(["name","email","phone","address","country","state","district","ward","message","coupon"])).forEach(function(t){L.custom_fields[t]=p[t]}),n.sendRequest("POST",n.const.API_LADISALE_CHECKOUT_CREATE,JSON.stringify(L),!0,{"Content-Type":"application/json"},function(t,e,i){if(i.readyState==XMLHttpRequest.DONE){if(200==e)try{var a=JSON.parse(t);if(200==a.code&&isObjectLadiPage(a.data)&&!isEmptyLadiPage(a.data.url))return void window.ladi(window.ladi(a.data.url).get_url()).open_url();if(!isEmptyLadiPage(a.message))return void n.showMessage(a.message)}catch(t){}n.showMessage(n.const.LANG.REQUEST_SEND_ERROR)}})}}(e),!1}c({isFormOtp:!1})}}else{var h=o[r].querySelectorAll('[type="checkbox"]');if(h.length>0){h[0].setAttribute("required","required");for(var E=0;E<h.length;E++)h[E].removeEventListener("change",B),h[E].addEventListener("change",B);e.querySelector(".ladi-form").reportValidity()}}}return!1},J=function(t,e,i,a){var o=n.findAncestor(t.target,"ladi-form");if(!isEmptyLadiPage(o)){var r=n.findAncestor(o,"ladi-element");if(!(isEmptyLadiPage(r)||(i=e?i:n.runtime.eventData[r.id],isEmptyLadiPage(i)||!i["option.is_buy_now"]&&!i["option.is_add_to_cart"]||isEmptyLadiPage(i["option.product_type"])||isEmptyLadiPage(i["option.product_id"])))){var d=function(){var o=n.generateVariantProduct(i,!1,null,null,null,null,!0,!0,d);if(isEmptyLadiPage(o)||isEmptyLadiPage(o.store_info)||isEmptyLadiPage(o.product))isEmptyLadiPage(n.runtime.tmp.timeout_product_info[i["option.product_type"]][i["option.product_id"]])&&n.showMessage(n.const.LANG.ADD_TO_CART_NO_PRODUCT,{name:n.getMessageNameProduct()});else{var c=-1,s=null;if(e){var u=r.querySelector('[data-variant="true"]');s=n.getProductVariantId(u,o.product),isEmptyLadiPage(s)||(c=o.product.variants.findIndex(function(t){return t.product_variant_id==s}))}else c=n.getProductVariantIndex(r.id,i);if(-1!=c){var p=o.product.variants[c].product_id;s=o.product.variants[c].product_variant_id;var l=o.product.name,m=o.product.variants[c].title,_=o.product.variants[c].price,g=o.product.variants[c].quantity,f=o.product.variants[c].quantity_stock;g=isNullLadiPage(f)?g:f;var y=isEmptyLadiPage(o.product.variants[c].src)?"":o.product.variants[c].src;y=isEmptyLadiPage(y)&&isObjectLadiPage(o.product.image)?o.product.image.src:y,isEmptyLadiPage(y)||!isStringLadiPage(y)||y.startsWith("http://")||y.startsWith("https://")||y.startsWith("//")||(y="https://"+n.const.STATIC_W_DOMAIN+"/"+y);if(0==o.product.select_many_service&&isArrayLadiPage(n.runtime.tmp.cart)&&-1!=n.runtime.tmp.cart.findIndex(function(t){return t.product_id==p&&t.product_variant_id!=s&&t.quantity>0}))n.showMessage(n.const.LANG.ADD_TO_CART_PRODUCT_ONLY_ONE,{name:n.getMessageNameProduct(o.product.variants[c])});else{var h=n.runtime.tmp.cart.findIndex(function(t){return t.product_variant_id==s}),E=!1;if(-1==h){E=!0;var v={store_id:o.store_info.id,product_id:p,product_variant_id:s,name:l,title:m,price:_,image:y,quantity:0,min_buy:o.product.variants[c].min_buy,max_buy:o.product.variants[c].max_buy,inventory_checked:o.product.variants[c].inventory_checked,available_quantity:g,currency:o.store_info.currency,product_type:o.product.variants[c].product_type,package_quantity:o.product.variants[c].package_quantity};isObjectLadiPage(v.currency)&&!isEmptyLadiPage(v.currency.code)&&(v.currency.symbol=n.formatCurrency(null,v.currency.code,!1,!0)),n.runtime.tmp.cart.push(v),h=n.runtime.tmp.cart.length-1}var L=r.querySelector('input[name="quantity"]');if(isEmptyLadiPage(L)||isEmptyLadiPage(L.value))n.showMessage(n.const.LANG.ADD_TO_CART_QUANTITY_REQUIRED);else{var P=parseInt(L.value)||0;if(P<=0)return void n.showMessage(n.const.LANG.ADD_TO_CART_QUANTITY_REQUIRED);var A=null,w=1;w=o.product.variants[c].min_buy||w;var O=o.product.variants[c].max_buy;w>n.runtime.tmp.cart[h].quantity+P&&(P=w-n.runtime.tmp.cart[h].quantity);var T=!1;if(!isEmptyLadiPage(O)&&n.runtime.tmp.cart[h].quantity+P>O&&(P=O-n.runtime.tmp.cart[h].quantity)<=0&&(T=!0,A=O),1==o.product.variants[c].inventory_checked){if(w>g)return void n.showMessage(n.const.LANG.ADD_TO_CART_NO_QUANTITY,{name:n.getMessageNameProduct(o.product.variants[c],!0)});n.runtime.tmp.cart[h].quantity+P>g&&(P=g-n.runtime.tmp.cart[h].quantity,g>0&&(T=!0,(isEmptyLadiPage(A)||A>g)&&(A=g)))}if(T||P<=0&&g>0)n.showMessage(n.const.LANG.ADD_TO_CART_MAX_QUANTITY,{max:A,name:n.getMessageNameProduct(o.product.variants[c])},function(){var e=t.target;e=n.findAncestor(e,"ladi-button"),isEmptyLadiPage(e)||(e=n.findAncestor(e,"ladi-element"));var i=n.runtime.eventData[e.id];if(!isEmptyLadiPage(i)){var a=i["option.data_event"];if(!isArrayLadiPage(a)&&(a=[],isObjectLadiPage(i["option.data_action"]))){var o=n.copy(i["option.data_action"]);o.action_type=n.const.ACTION_TYPE.action,a.push(o)}a.forEach(function(t){t.action_type==n.const.ACTION_TYPE.action&&(t.type==n.const.DATA_ACTION_TYPE.popup_cart&&window.ladi("POPUP_CART").show(),t.type==n.const.DATA_ACTION_TYPE.popup_checkout&&(n.runtime.shopping_third_party?n.getThirdPartyCheckoutUrl(!0):window.ladi("POPUP_CHECKOUT").show()))})}});else if(P>0){var b=!isEmptyLadiPage(o.product.variants[c].start_date)&&new Date(o.product.variants[c].start_date).getTime()>Date.now(),k=!isEmptyLadiPage(o.product.variants[c].end_date)&&new Date(o.product.variants[c].end_date).getTime()<Date.now();if(b)n.showMessage(n.const.LANG.ADD_TO_CART_PRODUCT_BEFORE_START_DATE,{name:n.getMessageNameProduct(o.product.variants[c])});else if(k)n.showMessage(n.const.LANG.ADD_TO_CART_PRODUCT_AFTER_END_DATE,{name:n.getMessageNameProduct(o.product.variants[c])});else{var N=function(){n.runtime.tmp.cart[h].quantity+=P;var t={product_id:p,product_variant_id:s,quantity:P};t.product_type=n.runtime.tmp.cart[h].product_type,t.package_quantity=n.runtime.tmp.cart[h].package_quantity,n.addCartCookie(o.store_info.id,t,function(){isFunctionLadiPage(a)&&a();var t=document.getElementsByClassName("ladi-form-remove-coupon")[0];isEmptyLadiPage(t)||t.click(),n.updateCartPromotion()},function(t){n.runtime.tmp.cart[h].quantity-=P,E&&n.runtime.tmp.cart.splice(h,1),n.showMessage(t.message)},function(){LadiPageShopping.push(function(){n.runtime.tmp.generateCart()}),LadiPageShopping.push(function(){n.changeTotalPriceCart()}),n.runtime.tmp.is_click_add_to_cart=!1,0==n.runtime.tmp.cart.length&&-1!=[n.const.FORM_CONFIG_TYPE.ladisales].indexOf(n.runtime.shopping_product_type)&&(window.ladi("_cart_token").delete_cookie(),window.ladi("_checkout_token").delete_cookie()),n.runResizeAll()})};if(isEmptyLadiPage(window.ladi("_cart_token").get_cookie()))if(n.runtime.tmp.is_click_add_to_cart){var S=function(){n.runTimeout(function(){if(n.runtime.tmp.is_click_add_to_cart)return S();d()},100)};S()}else n.runtime.tmp.is_click_add_to_cart=!0,N();else N()}}else g<=0&&n.showMessage(n.const.LANG.ADD_TO_CART_NO_QUANTITY,{name:n.getMessageNameProduct(o.product.variants[c],!0)})}}}else n.showMessage(n.const.LANG.ADD_TO_CART_PRODUCT_REQUIRED,{name:n.getMessageNameProduct(o.product.variants[c])})}};LadiPageShopping.push(function(){d()})}}},Q=function(t){J(t,!1,null,function(){var e=n.findAncestor(t.target,"ladi-button");e=n.findAncestor(e||t.target,"ladi-element");var i=n.runtime.eventData[e.id];if(!isEmptyLadiPage(i)){var a=i["option.data_event"];if(!isArrayLadiPage(a)&&(a=[],isObjectLadiPage(i["option.data_action"]))){var o=n.copy(i["option.data_action"]);o.action_type=n.const.ACTION_TYPE.action,a.push(o)}a.forEach(function(t){if(t.action_type==n.const.ACTION_TYPE.action){var e=null;t.type==n.const.DATA_ACTION_TYPE.popup_cart&&(e="POPUP_CART"),t.type==n.const.DATA_ACTION_TYPE.popup_checkout&&(e="POPUP_CHECKOUT"),t.type==n.const.DATA_ACTION_TYPE.popup_checkout&&n.runtime.shopping_third_party?n.getThirdPartyCheckoutUrl(!0):isEmptyLadiPage(e)||window.ladi(e).show()}}),n.runEventTracking(e.id,{is_form:!1})}})},X=function(t){var e=n.findAncestor(t.target,"ladi-form");isEmptyLadiPage(e)||(e=n.findAncestor(e,"ladi-element"),isEmptyLadiPage(e)||window.ladi(e.id).submit())},K=function(t){var e=n.findAncestor(t.target,"ladi-form");if(!isEmptyLadiPage(e)){var i=n.findAncestor(e,"ladi-element");if(!isEmptyLadiPage(i)){var a=n.runtime.eventData[i.id];if(!isEmptyLadiPage(a)){var o={};if(isObjectLadiPage(a["option.form_setting"])&&a["option.form_setting"].is_multiple){if(!a["option.form_setting"].is_multiple_otp)return void Y(i,a,!0,t.target.getAttribute("name"),{isRunTracking:!0});o.isFormOtp=!0,o.isCapture=!0}if(a["option.form_auto_capture"]&&!isEmptyLadiPage(a["option.form_config_id"])){var r=F(i.id,a["option.form_config_id"]);G(i,{captcha:!0},!0,r,t.target.getAttribute("name"),o)}}}}},V={};R.forEach(function(t){V[t]=window.ladi("_ladipage_"+t).get_cookie(),isEmptyLadiPage(e[t])||(V[t]=e[t])}),a=n.runtime.tmp.convertFormDataObjectCountry(V);var W=0,z=!1,Z=function(t){for(var e=c[W].querySelectorAll('.ladi-element .ladi-form-item-container [name="'+t+'"]'),i=null,o=0;o<e.length;o++){var r=V[t];if(!isEmptyLadiPage(r)&&"none"!=getComputedStyle(e[o]).display)if("true"!=e[o].getAttribute("data-is-select-country")&&(r=a[t]),"SELECT"==e[o].tagName)e[o].querySelectorAll('option[value="'+r+'"]').length>0&&(e[o].value=r,z&&n.fireEvent(e[o],"change"));else{if("country"==t&&"true"==e[o].getAttribute("data-is-select-country"))continue;"INPUT"==e[o].tagName&&"true"==e[o].getAttribute("data-is-select-country")&&2==(i=r.split(":")).length&&(r=i[1]),e[o].value=r,z&&n.fireEvent(e[o],"change")}}},$=function(t){t.target.type="date",t.target.focus()},tt=function(t){isEmptyLadiPage(t.target.value)&&(t.target.type="text")};for(W=0;W<c.length;W++){c[W].onsubmit=H;for(var et=n.findAncestor(c[W],"ladi-element"),it=c[W].getElementsByClassName("ladi-button"),at=0;at<it.length;at++){var nt=c[W].getElementsByClassName("ladi-button")[at];if(!isEmptyLadiPage(nt)){var ot=n.findAncestor(nt,"ladi-element");isEmptyLadiPage(et)||isEmptyLadiPage(n.runtime.eventData[et.id])||!n.runtime.eventData[et.id]["option.is_add_to_cart"]?ot.addEventListener("click",X):(ot.setAttribute("data-click",!1),ot.addEventListener("click",Q))}}var rt=c[W].querySelector('[data-is-select-country="true"][name="country"]');if(!isEmptyLadiPage(rt)&&"true"==rt.getAttribute("data-no-ward")){var dt=c[W].querySelector('[data-is-select-country="true"][name="ward"]');isEmptyLadiPage(dt)||dt.removeAttribute("required")}for(var ct=c[W].querySelectorAll('input[data-type="date"]'),st=0;st<ct.length;st++)isEmptyLadiPage(ct[st].getAttribute("placeholder"))||(n.runtime.isDesktop||n.runtime.isBrowserDesktop?(ct[st].setAttribute("type","text"),ct[st].addEventListener("focus",$),ct[st].addEventListener("blur",tt)):ct[st].value=(new Date).toISOString().substr(0,10));var ut=c[W].querySelectorAll("[tabindex]"),pt=0,lt=0;for(st=0;st<ut.length;st++)(lt=parseInt(ut[st].getAttribute("tabindex"))||0)>pt&&(pt=lt),ut[st].setAttribute("tabindex",n.runtime.tabindexForm+lt);for(ut=c[W].querySelectorAll("[data-tabindex]"),st=0;st<ut.length;st++)(lt=parseInt(ut[st].getAttribute("data-tabindex"))||0)>pt&&(pt=lt),ut[st].setAttribute("data-tabindex",n.runtime.tabindexForm+lt);n.runtime.tabindexForm+=pt;for(var mt=0;mt<C.length;mt++){var _t=c[W].querySelector('.ladi-element .ladi-form-item-container input[name="'+C[mt]+'"]');isEmptyLadiPage(_t)||_t.addEventListener("focusout",K)}}var gt=function(t,e){for(z=e,W=0;W<c.length;W++){var i=n.findAncestor(c[W],"ladi-element");!isEmptyLadiPage(n.runtime.eventData[i.id])&&n.runtime.eventData[i.id]["option.form_auto_complete"]&&t.forEach(Z)}};gt(n.copy(R).except(n.runtime.list_set_value_name_country));LadiPageLocation.push(function(){var t="",e="",i="",a="",o=null,r=function(t,e){var i=String(o[t].name),a=String(o[e].name);try{return i.localeCompare(a)}catch(t){}return i==a?0:i>a?1:-1},d=function(i){var a=window.LadiLocation[e];if(isObjectLadiPage(a)){var n=a.data[i];isEmptyLadiPage(n)||(t+='<option value="'+n.id+":"+n.name+'">'+n.name+"</option>")}},s=function(t){var e=window.LadiLocation[t.target.getAttribute("data-country")];if(isObjectLadiPage(e)){var a=e.data[t.target.value.split(":")[0]];if(i="",!isEmptyLadiPage(a)&&isObjectLadiPage(a.data)){var d=Object.keys(a.data);o=a.data,d.sort(r),d.forEach(function(t){var e=a.data[t];i+='<option value="'+e.id+":"+e.name+'">'+e.name+"</option>"})}var c=n.findAncestor(t.target,"ladi-element");if(!isEmptyLadiPage(c)){var s=c.querySelector('[name="district"]');isEmptyLadiPage(s)||"SELECT"==s.tagName&&(s.setAttribute("data-selected",""),s.innerHTML=s.querySelector("option").outerHTML+i);var u=c.querySelector('[name="ward"]');isEmptyLadiPage(u)||"SELECT"==u.tagName&&(u.setAttribute("data-selected",""),u.innerHTML=u.querySelector("option").outerHTML),LadiPageShopping.push(function(){n.reloadFeeShipping({target:u})})}}},u=function(t){var e=n.findAncestor(t.target,"ladi-element");if(!isEmptyLadiPage(e)){var i=e.querySelector('[name="ward"]');if(!isEmptyLadiPage(i)){a="";var d=e.querySelector('select[name="state"]');if(!isEmptyLadiPage(d)){var c=d.getAttribute("data-selected");if(!isEmptyLadiPage(c)){c=c.split(":")[0];var s=window.LadiLocation[d.getAttribute("data-country")];if(isObjectLadiPage(s)){var u=s.data[c];if(!isEmptyLadiPage(u)&&isObjectLadiPage(u.data)){var p=u.data[t.target.value.split(":")[0]];if(!isEmptyLadiPage(p)){var l=Object.keys(p.data);o=p.data,l.sort(r),l.forEach(function(t){var e=p.data[t];a+='<option value="'+e.id+":"+e.name+'">'+e.name+"</option>"})}}}}}"SELECT"==i.tagName&&(i.setAttribute("data-selected",""),i.innerHTML=i.querySelector("option").outerHTML+a);var m=e.querySelector('[name="district"]');isEmptyLadiPage(m)||"SELECT"!=m.tagName||LadiPageShopping.push(function(){n.reloadFeeShipping({target:i})})}}},p=function(t){var e=n.findAncestor(t.target,"ladi-element");if(!isEmptyLadiPage(e)){var i=e.querySelector('[name="ward"]');isEmptyLadiPage(i)||"SELECT"!=i.tagName||LadiPageShopping.push(function(){n.reloadFeeShipping()})}};for(W=0;W<c.length;W++){var l=c[W].querySelectorAll('.ladi-element .ladi-form-item-container [name="state"]'),m=0,_=null;for(m=0;m<l.length;m++)if(_=n.findAncestor(l[m],"ladi-element"),!isEmptyLadiPage(_)&&(e=n.runtime.eventData[_.id]["option.input_country"],!isEmptyLadiPage(e)&&(t="",e=e.split(":")[0],isObjectLadiPage(window.LadiLocation[e])))){var g=window.LadiLocation[e].data,f=Object.keys(g);o=g,f.sort(r),isArrayLadiPage(n.runtime.country_state_sort[e])&&(f=f.except(n.runtime.country_state_sort[e]),f=n.runtime.country_state_sort[e].concat(f)),f.forEach(d),l[m].setAttribute("data-country",e),l[m].innerHTML=l[m].querySelector("option").outerHTML+t,l[m].removeEventListener("change",s),l[m].addEventListener("change",s)}var y=c[W].querySelectorAll('.ladi-element .ladi-form-item-container [name="district"]');for(m=0;m<y.length;m++)y[m].removeEventListener("change",u),y[m].addEventListener("change",u);var h=c[W].querySelectorAll('.ladi-element .ladi-form-item-container [name="ward"]');for(m=0;m<h.length;m++)h[m].removeEventListener("change",p),h[m].addEventListener("change",p)}}),LadiPageLocation.push(function(){gt(D,!0)}),n.runtime.tmp.buttonAddToCartClick=J},LadiPageScriptV2.prototype.setInputOtp=function(){for(var t=this,e=document.querySelectorAll(".ladi-form .ladi-element .ladi-form-otp"),i=function(e,a){var n=t.findAncestor(a,"ladi-form");if(!isEmptyLadiPage(n)&&(n=t.findAncestor(n,"ladi-element"),!isEmptyLadiPage(n))){var o="_otp_time_"+n.id,r=window.ladi(o).get_cookie(),d=t.runtime.tmp["cookie_cache_otp_"+n.id];isEmptyLadiPage(r)&&isObjectLadiPage(d)&&!isEmptyLadiPage(d[o])&&(r=d[o]);var c=(r=parseFloatLadiPage(r)||0)+t.runtime.time_otp-Date.now();c=c<t.runtime.time_otp?c:0,r<=0||c<=0?function(t){t.classList.add("otp-resend"),t.classList.remove("otp-countdown"),t.removeAttribute("data-countdown-time")}(e):(c=Math.ceil(c/1e3),e.classList.remove("otp-resend"),e.classList.add("otp-countdown"),e.setAttribute("data-countdown-time",c),t.runTimeout(function(){i(e,a)},1e3))}},a=function(e){var a=t.findAncestor(e.target,"ladi-form");if(!isEmptyLadiPage(a)&&(a=t.findAncestor(a,"ladi-element"),!isEmptyLadiPage(a))){var n="_otp_time_"+a.id,o=!1,r=t.runtime.tmp["cookie_cache_otp_"+a.id],d=function(){a.removeAttribute("data-start-countdown-otp");var d=new Date;d.setTime(d.getTime()+t.runtime.time_otp),o?(r[n]=Date.now(),t.runtime.tmp["cookie_cache_otp_"+a.id]=r):window.ladi(n).set_cookie(Date.now(),d);var c=t.findAncestor(e.target,"ladi-form-item");t.runTimeout(function(){i(c,e.target)},1)};if("true"!=a.getAttribute("data-start-countdown-otp")){var c=window.ladi(n).get_cookie();isEmptyLadiPage(c)&&isObjectLadiPage(r)&&!isEmptyLadiPage(r[n])&&(c=r[n],o=!0);var s=(c=parseFloatLadiPage(c)||0)+t.runtime.time_otp-Date.now();s=s<t.runtime.time_otp?s:0,(c<=0||s<=0)&&"true"!=e.target.getAttribute("data-click")&&isFunctionLadiPage(t.runtime.func_get_code_otp[a.id])&&(t.removeTimeout(t.runtime.tmp.timeout_is_wait_popup_id),t.runtime.tmp.is_wait_popup=!0,t.showLoadingBlur(),e.target.setAttribute("data-click",!0),t.runtime.func_get_code_otp[a.id](!0,function(i){e.target.removeAttribute("data-click"),t.hideLoadingBlur(),i&&d(),t.runtime.tmp.timeout_is_wait_popup_id=t.runTimeout(function(){delete t.runtime.tmp.is_wait_popup},200)}))}else d()}},n=0;n<e.length;n++){var o=e[n],r=t.findAncestor(o,"ladi-form-item");if(!isEmptyLadiPage(r)){r.classList.add("overflow-hidden");var d=r.getElementsByClassName("button-get-code")[0];isEmptyLadiPage(d)&&((d=document.createElement("div")).className="button-get-code",d.innerHTML=t.const.LANG.GET_CODE_BUTTON_TEXT,d.addEventListener("click",a),r.appendChild(d)),d.classList.add("hide-visibility"),o.style.setProperty("padding-right",d.clientWidth+5+"px"),d.classList.remove("hide-visibility"),i(r,d)}}},LadiPageScriptV2.prototype.setInputFile=function(){for(var t=this,e=document.querySelectorAll(".ladi-form .ladi-element .ladi-form-control-file"),i=function(e){var i=e.target,a=i.getAttribute("data-click-id")||t.randomId();i.setAttribute("data-click-id",a);var n=document.getElementById("ladi-input-file");if(isEmptyLadiPage(n)){(n=document.createElement("input")).id="ladi-input-file";var o=t.findAncestor(i,"ladi-element");!isEmptyLadiPage(o)&&o.classList.contains("accept-all")||n.setAttribute("accept",".jpg, .jpeg, .png, .gif, .svg, .ico, .mp3, .mp4, .ttf, .otf, .woff2, .txt, .doc, .docx, .xls, .xlsx, .pdf"),n.setAttribute("style","position: absolute; top: 0; left: 0; visibility: hidden;"),n.multiple=!0,n.type="file",document.body.appendChild(n)}n.setAttribute("data-file-click-id",a),"true"!=n.getAttribute("data-event")&&(n.setAttribute("data-event",!0),n.addEventListener("change",function(e){!function(e,i,a){if(i.length>t.const.FORM_UPLOAD_FILE_LENGTH)t.showMessage(t.const.LANG.FORM_UPLOAD_FILE_MAX_LENGTH_ERROR,{max_length:t.const.FORM_UPLOAD_FILE_LENGTH});else{for(var n=new FormData,o=0,r=0;r<i.length;r++)o+=i[r].size,n.append("file[]",i[r]);if(o>1024*t.const.FORM_UPLOAD_FILE_SIZE*1024)t.showMessage(t.const.LANG.FORM_UPLOAD_FILE_MAX_SIZE_ERROR,{max_size:t.const.FORM_UPLOAD_FILE_SIZE});else{var d={ladipage_id:t.runtime.ladipage_id,lang:t.runtime.lang};n.append("json_data",JSON.stringify(d)),t.showLoadingBlur(),t.sendRequest("POST",t.const.API_FILE_UPLOAD,n,!0,null,function(i,a,n){if(n.readyState==XMLHttpRequest.DONE){if(t.hideLoadingBlur(),200==a)try{var o=JSON.parse(i);if(200==o.code){var r=[],d=[];return o.data.success.forEach(function(t){r.push(t.name),d.push({id:t._id,path:t.path,name:t.name})}),e.value=r.length>0?"["+r.join(", ")+"]":"",void e.setAttribute("data-path-file",JSON.stringify(d))}if(!isEmptyLadiPage(o.message))return void t.showMessage(o.message)}catch(t){}t.showMessage(t.const.LANG.REQUEST_SEND_ERROR)}}),isFunctionLadiPage(a)&&a()}}}(i=document.querySelector('[data-click-id="'+e.target.getAttribute("data-file-click-id")+'"]'),e.target.files,function(){e.target.value=null})})),n.click()},a=0;a<e.length;a++){var n=e[a];n.readOnly=!0,n.style.setProperty("cursor","pointer"),n.addEventListener("click",i)}},LadiPageScriptV2.prototype.runFormItem=function(t,e,i){var a=this;if("form_item"==e){var n=null,o=null;if((i==a.const.INPUT_TYPE.select||i==a.const.INPUT_TYPE.select_multiple)&&(n=document.getElementById(t),!isEmptyLadiPage(n)))for(var r=n.getElementsByClassName("ladi-form-control"),d=0;d<r.length;d++)r[d].addEventListener("change",function(t){t.target.setAttribute("data-selected",t.target.value)});if(i==a.const.INPUT_TYPE.checkbox){n=document.getElementById(t);var c=function(t){t.stopPropagation();var e=a.findAncestor(t.target,"ladi-form-checkbox-item");isEmptyLadiPage(e)||e.getElementsByTagName("span")[0].setAttribute("data-checked",t.target.checked)},s=function(t){t.stopPropagation();var e=a.findAncestor(t.target,"ladi-form-checkbox-item");isEmptyLadiPage(e)||e.getElementsByTagName("input")[0].click()};if(!isEmptyLadiPage(n)){o=n.getElementsByClassName("ladi-form-checkbox-item");for(var u=0;u<o.length;u++){var p=o[u].getElementsByTagName("input")[0];o[u].getElementsByTagName("span")[0].addEventListener("click",s),p.addEventListener("change",c)}}}if(i==a.const.INPUT_TYPE.radio){n=document.getElementById(t);var l=function(t){var e=a.findAncestor(t.target,"ladi-form-checkbox-item"),i=a.findAncestor(e,"ladi-form-checkbox");if(!isEmptyLadiPage(i)){for(var n=i.querySelectorAll(".ladi-form-checkbox-item span"),o=0;o<n.length;o++)n[o].setAttribute("data-checked",!1);isEmptyLadiPage(e)||e.getElementsByTagName("span")[0].setAttribute("data-checked",t.target.checked)}},m=function(t){t.stopPropagation();var e=a.findAncestor(t.target,"ladi-form-checkbox-item");isEmptyLadiPage(e)||e.getElementsByTagName("input")[0].click()};if(!isEmptyLadiPage(n)){o=n.getElementsByClassName("ladi-form-checkbox-item");for(var _=0;_<o.length;_++){var g=o[_].getElementsByTagName("input")[0];o[_].getElementsByTagName("span")[0].addEventListener("click",m),g.addEventListener("change",l)}}}}},LadiPageScriptV2.prototype.runFormData=function(t){isFunctionLadiPage(t)&&t()},function(){var t=window.LadiPageFormData||[];window.LadiPageFormData={},window.LadiPageFormData.push=function(t){LadiPageScript.runFormData(t)},t.forEach(function(t){window.LadiPageFormData.push(t)})}();